<script type="text/javascript">
	// <![CDATA[
		AUI().use(
			'aui-base',
			function(A) {
				const frameElement = window.frameElement;

				if (frameElement && frameElement.getAttribute('id') === 'simulationDeviceIframe') {
					A.getBody().addClass('lfr-has-simulation-panel');

					if (frameElement.contentWindow.location.href.includes('p_l_mode=preview')) {
						return;
					}

					const currentLocationHasParams = frameElement.contentWindow.location.href.includes('?');
					const safePreviewURL = `${frameElement.contentWindow.location.href}${currentLocationHasParams ? '&' : '?'}p_l_mode=preview`;

					frameElement.contentWindow.location.replace(safePreviewURL);
				}
			}
		);
	// ]]>
</script>